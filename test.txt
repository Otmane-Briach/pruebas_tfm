edr@edr-VMware-Virtual-Platform:~/Desktop/mini-edr-ebpf$ ./testing_sistema.sh 
================================================
    TEST COMPLETO EDR - COLLECTOR + DETECTOR   
================================================

ğŸ§¹ Limpiando estado previo...
ğŸš€ Iniciando pipeline EDR completo...
   Collector â†’ Detector â†’ Alertas

   Pipeline iniciado (PID: 7213)
   Esperando inicializaciÃ³n...
..âœ“ Sistema EDR activo


â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
TEST 1: DETECCIÃ“N DE BORRADO MASIVO
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Simulando borrado de mÃºltiples archivos crÃ­ticos...
âœ“ Creados 24 archivos crÃ­ticos
Borrando archivos rÃ¡pidamente...
âœ“ Archivos borrados

Verificando alertas generadas...
âœ… DETECCIÃ“N EXITOSA: Borrado masivo detectado
ALERTA: BORRADO MASIVO: 10 archivos eliminados en 30s (PID 7213)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
TEST 2: ESCALACIÃ“N DE PRIVILEGIOS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Creando binario y aplicando SETUID...
âœ“ Script creado
âœ“ SETUID aplicado
âœ“ Permisos sospechosos aplicados

Verificando alertas de privilegios...
âœ… DETECCIÃ“N EXITOSA: EscalaciÃ³n de privilegios detectada
Tabla events creada con esquema expandido (incluye UNLINK/CHMOD)
ALERTA: ALERTA CRÃTICA: SETUID en ubicaciÃ³n sospechosa: /tmp/edr_full_test_1755119641/backdoor.sh

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
TEST 3: PATRÃ“N RANSOMWARE COMPLETO
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Simulando: crear â†’ cifrar â†’ borrar â†’ cambiar permisos
Fase 1: Creando archivos vÃ­ctima...
Fase 2: Cifrando y borrando originales...
âœ“ PatrÃ³n ransomware ejecutado

Verificando detecciÃ³n de ransomware...
âš  No se detectÃ³ patrÃ³n ransomware

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ANÃLISIS DE RESULTADOS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“Š Eventos capturados:
   Total eventos: 1437
   â”œâ”€ UNLINK: 77
   â”œâ”€ CHMOD: 12
   â””â”€ WRITE: 9

ğŸš¨ Alertas generadas:
   Total alertas: 50
   Tipos de alertas:
      2 ALERTA CRÃTICA
     48 Archivo en ubicaciÃ³n
      1 BORRADO MASIVO

ğŸ’¾ Base de datos:
   Eventos guardados: 1700
   Eventos con alerta: 52

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
VALIDACIÃ“N DEL SISTEMA
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   âœ“ Nuevas syscalls funcionando
   âœ“ Sistema de alertas activo
   âœ“ Persistencia en BD funcionando
   âœ“ DetecciÃ³n de amenazas activa
   âœ“ Sistema estable

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… SISTEMA EDR COMPLETAMENTE FUNCIONAL (5/5)
Las nuevas syscalls estÃ¡n integradas y detectando amenazas
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ§¹ Limpiando...

ğŸ“ Logs guardados en:
   - /tmp/edr_full.log (eventos JSON)
   - /tmp/edr_alerts.log (alertas del detector)
   - /tmp/edr.err (errores/debug)
   - edr_events.db (base de datos)

âœ¨ Test completado
edr@edr-VMware-Virtual-Platform:~/Desktop/mini-edr-ebpf$ 
