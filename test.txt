edr@edr-VMware-Virtual-Platform:~/Desktop/mini-edr-ebpf$ ./testing_sistema.sh 
================================================
    TEST COMPLETO EDR - COLLECTOR + DETECTOR   
================================================

🧹 Limpiando estado previo...
🚀 Iniciando pipeline EDR completo...
   Collector → Detector → Alertas

   Pipeline iniciado (PID: 7213)
   Esperando inicialización...
..✓ Sistema EDR activo


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
TEST 1: DETECCIÓN DE BORRADO MASIVO
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Simulando borrado de múltiples archivos críticos...
✓ Creados 24 archivos críticos
Borrando archivos rápidamente...
✓ Archivos borrados

Verificando alertas generadas...
✅ DETECCIÓN EXITOSA: Borrado masivo detectado
ALERTA: BORRADO MASIVO: 10 archivos eliminados en 30s (PID 7213)

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
TEST 2: ESCALACIÓN DE PRIVILEGIOS
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Creando binario y aplicando SETUID...
✓ Script creado
✓ SETUID aplicado
✓ Permisos sospechosos aplicados

Verificando alertas de privilegios...
✅ DETECCIÓN EXITOSA: Escalación de privilegios detectada
Tabla events creada con esquema expandido (incluye UNLINK/CHMOD)
ALERTA: ALERTA CRÍTICA: SETUID en ubicación sospechosa: /tmp/edr_full_test_1755119641/backdoor.sh

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
TEST 3: PATRÓN RANSOMWARE COMPLETO
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Simulando: crear → cifrar → borrar → cambiar permisos
Fase 1: Creando archivos víctima...
Fase 2: Cifrando y borrando originales...
✓ Patrón ransomware ejecutado

Verificando detección de ransomware...
⚠ No se detectó patrón ransomware

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
ANÁLISIS DE RESULTADOS
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📊 Eventos capturados:
   Total eventos: 1437
   ├─ UNLINK: 77
   ├─ CHMOD: 12
   └─ WRITE: 9

🚨 Alertas generadas:
   Total alertas: 50
   Tipos de alertas:
      2 ALERTA CRÍTICA
     48 Archivo en ubicación
      1 BORRADO MASIVO

💾 Base de datos:
   Eventos guardados: 1700
   Eventos con alerta: 52

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
VALIDACIÓN DEL SISTEMA
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   ✓ Nuevas syscalls funcionando
   ✓ Sistema de alertas activo
   ✓ Persistencia en BD funcionando
   ✓ Detección de amenazas activa
   ✓ Sistema estable

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ SISTEMA EDR COMPLETAMENTE FUNCIONAL (5/5)
Las nuevas syscalls están integradas y detectando amenazas
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🧹 Limpiando...

📝 Logs guardados en:
   - /tmp/edr_full.log (eventos JSON)
   - /tmp/edr_alerts.log (alertas del detector)
   - /tmp/edr.err (errores/debug)
   - edr_events.db (base de datos)

✨ Test completado
edr@edr-VMware-Virtual-Platform:~/Desktop/mini-edr-ebpf$ 
